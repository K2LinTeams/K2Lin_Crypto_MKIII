# 技术规格 (Technical Specifications)

本文档概述了 K2Lin Crypto MKIII 的加密原语和安全架构。

> **[PRTS 系统日志]:**
> 主题: **源代码分析**
> 权限: **等级 3 (管理员)**

## 1. 密码学 (Cryptography)

### 对称加密
*   **算法**: AES-256-GCM (Galois/Counter Mode).
*   **密钥派生**: `scrypt`.
    *   参数: `N=16384`, `r=8`, `p=1`.
    *   盐值长度: 16 字节.
*   **IV (初始化向量)**: 12 字节 (96 bits), 每次加密随机生成.
*   **认证标签 (Tag)**: 128 bits (16 字节).

### 非对称加密
*   **算法**: 混合加密方案 (ECC + AES).
*   **密钥交换**: X25519 (Curve25519 用于 ECDH).
*   **载荷加密**: AES-256-GCM.
    *   每次发送消息时生成一对临时的 X25519 密钥对。
    *   使用 ECDH 协商出共享密钥。
    *   使用该共享密钥加密消息。
    *   将临时公钥附带在加密载荷中。

> **[凯尔希医生的手记]:** 我们选择 X25519 而非 RSA，是因为其卓越的性能和更小的密钥尺寸，这能有效减轻移动终端设备的运算负荷。

### 身份生成
*   **ID 格式**: 12 位数字 (如 `0000 0000 0000`).
*   **派生算法**:
    1.  计算公钥 (SPKI 格式) 的 SHA-256 哈希值。
    2.  将哈希转换为 BigInt。
    3.  对 $10^{12}$ 取模。

---

## 2. 隐写术 (Steganography)

### 最低有效位 (LSB)
*   **方法**: 顺序 LSB 替换。
*   **通道**: 使用 R, G, B 通道；保留 Alpha 通道以维持透明度。
*   **容量**: 约每像素 3 比特 (每个通道 1 比特)。

### 混淆层 (Obfuscation)
为了防止简单的统计检测，原始载荷在嵌入前会进行 XOR 掩码处理。

*   **掩码密钥**: `0x7A, 0x21, 0x9F, 0x4D` (循环 4 字节密钥)。
*   **文件头**: 自定义 `C3` 签名头 (`0x43, 0x33`) 用于格式验证。

> **[PRTS 警告]:** 此混淆层 **并非** 加密。它能有效躲避自动化扫描器的侦测，但拥有深度分析能力的顽固敌人仍可能发现规律。务必在嵌入前先对数据进行加密。

---

## 3. NLP 伪装 (Mimic)

*   **算法**: 马尔可夫链文本生成 (Markov Chain).
*   **语料库**: 预加载的语言数据集 (英文/中文).
*   **编码**: 密文字节到自然语言的高熵映射。
